/**
 * cosyModal
 * @author Jan Ebsen <xicrow@gmail.com>
 * @version 1.0.0
 * @date 2014-02-06
 * @copyright Jan Ebsen 2014
 */
(function(e){e.cosyModal={configuration:{width:600,height:"auto",showTime:500,hideTime:250},counter:0,animating:false,init:function(t,n){if(typeof t=="object"){t=e(t)}else if(e("#"+t).length){t=e("#"+t)}else{return false}if(!e("#cosyModal-overlay").length){e("<div></div>").attr("class","cosyModal-overlay").attr("id","cosyModal-overlay").appendTo("body")}if(t.data("cosyModal")){return true}n=e.extend({},e.cosyModal.configuration,n);n.id=t.attr("id");n.counter=e.cosyModal.counter;t.addClass("cosyModal");elmClose=t.find(".close");if(!elmClose.length){elmClose=e("<div></div>").attr("class","close").html("&times;").click(function(t){e(this).parents(".cosyModal").cosyModal("hide")}).appendTo(t)}else{elmClose.click(function(t){e(this).parents(".cosyModal").cosyModal("hide")})}t.find(".cosyModal-close").each(function(t,n){e(n).click(function(t){e(this).parents(".cosyModal").cosyModal("hide")})});t.data("cosyModal",n);t.detach().appendTo("body");maxHeight=e(window).height();maxHeight-=t.outerHeight(true)-t.height();if(maxHeight<100){maxHeight=100}t.css({width:n.width,height:n.height,maxHeight:maxHeight});t.css({marginTop:-t.outerHeight(true)});t.hide();e.cosyModal.counter++;return true},show:function(t){if(e.cosyModal.animating){return}t=e(t);if(!t){return false}modalConfig=t.data("cosyModal");if(!modalConfig){return false}t.trigger("cosyModalShow",[t[0]]);t.css({display:"block",opacity:0});animateOptions={marginTop:50,opacity:1};e.cosyModal.animating=true;t.animate(animateOptions,modalConfig.showTime,function(){e(this).show();e.cosyModal.animating=false;e(document).on("keydown.cosyModal",function(t){if(t.keyCode==27){e(".cosyModal:visible").cosyModal("hide")}});e(this).trigger("cosyModalShowed",[this])});elmOverlay=e("#cosyModal-overlay");if(elmOverlay.length){elmOverlay.bind("click",function(){e(".cosyModal:visible").cosyModal("hide")});elmOverlay.css({display:"block",opacity:0});elmOverlay.animate({opacity:1},modalConfig.showTime,function(){e(this).show()})}return true},hide:function(t){if(e.cosyModal.animating){return}t=e(t);if(!t){return false}modalConfig=t.data("cosyModal");if(!modalConfig){return false}t.trigger("cosyModalHide",[t[0]]);t.css({display:"block",opacity:1});animateOptions={marginTop:-t.outerHeight(true),opacity:0};e.cosyModal.animating=true;t.animate(animateOptions,modalConfig.hideTime,function(){e(this).hide();e.cosyModal.animating=false;e(document).off("keydown.cosyModal");e(this).trigger("cosyModalHided",[this])});elmOverlay=e("#cosyModal-overlay");if(elmOverlay.length){elmOverlay.css({display:"block",opacity:1});elmOverlay.animate({opacity:0},modalConfig.showTime,function(){e(this).hide()})}return true}};e.fn.extend({cosyModal:function(){if(typeof arguments[0]=="string"){switch(arguments[0]){case"show":case"open":return this.each(function(){e.cosyModal.show(this)});break;case"hide":case"close":return this.each(function(){e.cosyModal.hide(this)});break}}else{options=arguments[0];return this.each(function(){e.cosyModal.init(this,options)})}}});e(document).ready(function(){e('a[rel="modal:show"]').each(function(t,n){if(n.href.indexOf("#")){e(this.href.substr(this.href.indexOf("#"))).cosyModal();e(this).on("click.cosyModal",function(t){t.preventDefault();e(this.href.substr(this.href.indexOf("#"))).cosyModal("show")})}})});e(document).ready(function(){e('a[rel="modal:hide"]').each(function(t,n){if(n.href.indexOf("#")){e(this).on("click.cosyModal",function(t){t.preventDefault();e(this.href.substr(this.href.indexOf("#"))).cosyModal("hide")})}})})})(jQuery)